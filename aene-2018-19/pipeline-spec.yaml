aene-2018-19:
  title: Original and adjusted budget spending per department
  description: Data per department, provided for original and adjusted numbers
  pipeline:
  - run: load
    parameters:
      from: './aene18_19.csv'
      name: 'origin-data'
      format: 'csv'
  - run: delete_fields
    parameters:
      resources: origin-data
      fields:
      - Source
      - BudYear
      - Province
      - ValueIndi
      - Combo
      - FG1
      - FG2
      - GFS1
      - GFS2
      - GFS3
  - run: add_computed_field
    parameters:
      resources: origin-data
      fields:
      - operation: format
        target: Budget Phase
        with: '{FY_Descript}'
  - run: find_replace
    parameters:
      resources: origin-data
      fields:
      - name: FinYear
        patterns:
        - find: (\d{4})_\d{2}
          replace: \1
      - name: Budget Phase
        patterns:
        - find: ^((?!Voted \(Main appropriation\)).)*$
          replace: Adjusted appropriation
      - name: FY_Descript
        patterns:
        - find: ^(Voted \(Main appropriation\))
          replace: Total
        - find: ^(Adjusted appropriation)
          replace: Total
  - run: department_names
    parameters:
      sphere: national
      financial_year: 2018-19
      department_column: 'Department'
  - run: clean_value_field
    parameters:
      value_field: 'Value'
  - run: dump_to_path
    parameters:
      out-path: './processed'
      format: 'csv'


